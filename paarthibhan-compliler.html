<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Online Compiler - Created by Paarthibhan</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500&family=Inter:wght@400;600;700&display=swap');

        body {
            font-family: 'Inter', sans-serif;
            background-color: #0f172a; /* Slate 900 */
            color: #e2e8f0;
            overflow: hidden; /* Prevent body scroll, handle in containers */
        }

        .code-font {
            font-family: 'Fira Code', monospace;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #1e293b; 
        }
        ::-webkit-scrollbar-thumb {
            background: #475569; 
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #64748b; 
        }

        .editor-container {
            display: flex;
            flex-direction: column;
            height: 100vh;
        }

        .main-content {
            flex: 1;
            display: flex;
            overflow: hidden;
        }

        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }
            .panel {
                width: 100% !important;
                height: 50% !important;
            }
            .resizer {
                display: none;
            }
        }

        .panel {
            flex: 1;
            display: flex;
            flex-direction: column;
            min-width: 0;
        }

        textarea {
            resize: none;
            outline: none;
            border: none;
            line-height: 1.5;
            tab-size: 4;
        }
        
        /* Syntax Highlighting Simulation (Basic) */
        .token-keyword { color: #c678dd; }
        .token-string { color: #98c379; }
        .token-comment { color: #5c6370; font-style: italic; }

        .loader {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3498db;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
            display: inline-block;
            margin-right: 8px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="text-slate-300">

    <div class="editor-container">
        <!-- Navbar -->
        <nav class="h-14 bg-slate-900 border-b border-slate-700 flex items-center justify-between px-4 shrink-0">
            <div class="flex items-center gap-3">
                <div class="bg-blue-600 text-white p-1.5 rounded-lg shadow-lg shadow-blue-500/30">
                    <i class="fas fa-code"></i>
                </div>
                <div>
                    <h1 class="font-bold text-white text-lg leading-tight">DevCompiler</h1>
                    <p class="text-[10px] text-slate-400 font-mono">Created by Paarthibhan</p>
                </div>
            </div>

            <div class="flex items-center gap-2">
                <button onclick="runCode()" class="bg-green-600 hover:bg-green-500 text-white px-4 py-1.5 rounded-md font-semibold text-sm transition-all flex items-center gap-2 shadow-lg shadow-green-900/20 active:scale-95">
                    <i class="fas fa-play text-xs"></i> <span class="hidden sm:inline">Run</span>
                </button>
            </div>
        </nav>

        <!-- Language Tabs -->
        <div class="bg-slate-800 border-b border-slate-700 px-2 flex items-center gap-1 shrink-0 overflow-x-auto">
            <button onclick="switchLang('cpp')" id="tab-cpp" class="px-4 py-2 text-sm border-b-2 border-transparent hover:bg-slate-700/50 transition-colors text-slate-400">
                <i class="fab fa-cuttlefish mr-1 text-blue-400"></i> C++
            </button>
            <button onclick="switchLang('html')" id="tab-html" class="px-4 py-2 text-sm border-b-2 border-blue-500 bg-slate-700/50 text-white font-medium transition-colors">
                <i class="fab fa-html5 mr-1 text-orange-500"></i> HTML
            </button>
            <button onclick="switchLang('mysql')" id="tab-mysql" class="px-4 py-2 text-sm border-b-2 border-transparent hover:bg-slate-700/50 transition-colors text-slate-400">
                <i class="fas fa-database mr-1 text-yellow-400"></i> MySQL
            </button>
        </div>

        <!-- Main Workspace -->
        <div class="main-content bg-slate-900">
            
            <!-- Code Editor Panel -->
            <div class="panel border-r border-slate-700 bg-[#1e293b]">
                <div class="flex items-center justify-between px-3 py-1 bg-[#1e293b] text-xs text-slate-400 border-b border-slate-700 select-none">
                    <span>main<span id="file-ext">.html</span></span>
                    <span id="status-text">Ready</span>
                </div>
                <div class="relative flex-1">
                    <textarea id="code-editor" class="absolute inset-0 w-full h-full bg-[#1e293b] text-slate-200 code-font p-4 text-sm leading-6" spellcheck="false" placeholder="// Write your code here..."></textarea>
                </div>
            </div>

            <!-- Output Panel -->
            <div class="panel bg-black">
                <div class="flex items-center justify-between px-3 py-1 bg-slate-800 text-xs text-slate-400 border-b border-slate-700 select-none">
                    <span>Output / Terminal</span>
                    <button onclick="clearOutput()" class="hover:text-white"><i class="fas fa-ban"></i> Clear</button>
                </div>
                
                <!-- Iframe for HTML -->
                <div id="output-html-container" class="w-full h-full bg-white hidden">
                    <iframe id="preview-frame" class="w-full h-full border-none"></iframe>
                </div>

                <!-- Console for C++/MySQL -->
                <div id="output-console-container" class="w-full h-full p-4 code-font text-sm overflow-auto text-slate-300 hidden">
                    <div id="console-output">
                        <span class="text-slate-500">// Output will appear here...</span>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <!-- Scripts -->
    <script>
        // State
        let currentLang = 'html';
        
        // Default Code Templates
        const templates = {
            cpp: `#include <iostream>
using namespace std;

int main() {
    // Write C++ code here
    cout << "Hello, Paarthibhan!" << endl;
    return 0;
}`,
            html: `<!DOCTYPE html>
<html>
<head>
    <style>
        body { font-family: sans-serif; text-align: center; padding: 50px; background: #f0f9ff; }
        h1 { color: #0284c7; }
        button { padding: 10px 20px; background: #0284c7; color: white; border: none; border-radius: 5px; cursor: pointer; }
        button:hover { background: #0369a1; }
    </style>
</head>
<body>
    <h1>Welcome Web Dev!</h1>
    <p>This is a live HTML preview.</p>
    <button onclick="alert('It works!')">Click Me</button>
</body>
</html>`,
            mysql: `-- Create a table
CREATE TABLE Users (
    ID int,
    Name varchar(255),
    Role varchar(255)
);

-- Insert data
INSERT INTO Users (ID, Name, Role)
VALUES (1, 'Paarthibhan', 'Admin');

-- Query data
SELECT * FROM Users;`
        };

        // DOM Elements
        const editor = document.getElementById('code-editor');
        const fileExt = document.getElementById('file-ext');
        const htmlContainer = document.getElementById('output-html-container');
        const consoleContainer = document.getElementById('output-console-container');
        const consoleOutput = document.getElementById('console-output');
        const iframe = document.getElementById('preview-frame');
        const statusText = document.getElementById('status-text');

        // Init
        window.onload = () => {
            editor.value = templates.html;
            updateUIForLang('html');
            // Run HTML immediately on load for nice UX
            runCode();
        };

        function switchLang(lang) {
            currentLang = lang;
            
            // Update Tabs
            ['cpp', 'html', 'mysql'].forEach(l => {
                const tab = document.getElementById(`tab-${l}`);
                if (l === lang) {
                    tab.classList.remove('border-transparent', 'text-slate-400', 'hover:bg-slate-700/50');
                    tab.classList.add('border-blue-500', 'bg-slate-700/50', 'text-white', 'font-medium');
                } else {
                    tab.classList.add('border-transparent', 'text-slate-400', 'hover:bg-slate-700/50');
                    tab.classList.remove('border-blue-500', 'bg-slate-700/50', 'text-white', 'font-medium');
                }
            });

            // Update Editor Content & UI
            editor.value = templates[lang];
            updateUIForLang(lang);
            
            // Clear Output
            if(lang !== 'html') {
                consoleOutput.innerHTML = '<span class="text-slate-500">// Output will appear here...</span>';
            }
        }

        function updateUIForLang(lang) {
            if (lang === 'html') {
                fileExt.textContent = '.html';
                htmlContainer.classList.remove('hidden');
                consoleContainer.classList.add('hidden');
            } else if (lang === 'cpp') {
                fileExt.textContent = '.cpp';
                htmlContainer.classList.add('hidden');
                consoleContainer.classList.remove('hidden');
            } else {
                fileExt.textContent = '.sql';
                htmlContainer.classList.add('hidden');
                consoleContainer.classList.remove('hidden');
            }
        }

        function runCode() {
            const code = editor.value;
            statusText.innerHTML = '<span class="loader"></span> Running...';
            
            setTimeout(() => {
                statusText.innerText = "Ready";
                
                if (currentLang === 'html') {
                    // Real HTML Execution
                    const doc = iframe.contentWindow.document;
                    doc.open();
                    doc.write(code);
                    doc.close();
                } 
                else if (currentLang === 'cpp') {
                    // Simulated C++ Execution
                    simulateCpp(code);
                } 
                else if (currentLang === 'mysql') {
                    // Simulated MySQL Execution
                    simulateSql(code);
                }
            }, 600); // Fake delay for realism
        }

        function clearOutput() {
            if (currentLang === 'html') {
                const doc = iframe.contentWindow.document;
                doc.open();
                doc.write('');
                doc.close();
            } else {
                consoleOutput.innerHTML = '<span class="text-slate-500">// Output cleared</span>';
            }
        }

        // --- Simulation Logic ---

        function simulateCpp(code) {
            let output = "";
            const lines = code.split('\n');
            let hasMain = code.includes('int main');
            
            if (!hasMain) {
                output = `<span class="text-red-400">Error: 'main' function not found.</span>`;
            } else {
                // Extremely basic parsing to find cout strings
                output += `<div class="text-green-400 mb-2">Build finished successfully.</div>`;
                
                // Regex to find content inside cout << "..."
                const regex = /cout\s*<<\s*"([^"]*)"/g;
                let match;
                let foundOutput = false;
                
                while ((match = regex.exec(code)) !== null) {
                    output += `<div>${match[1]}</div>`;
                    foundOutput = true;
                }

                if (!foundOutput && code.includes('cout')) {
                    // Fallback if complex variables are used
                    output += `<div>(Program executed. Console output simulation is limited to static strings in this demo)</div>`;
                } else if (!foundOutput) {
                    output += `<div class="text-slate-500 text-xs mt-2">Program exited with code 0</div>`;
                }
            }
            
            consoleOutput.innerHTML = output;
        }

        function simulateSql(code) {
            let output = "";
            const upperCode = code.toUpperCase();
            
            if (upperCode.includes('SELECT') && upperCode.includes('FROM USERS')) {
                // Mock Table for Users
                output = `
                <div class="text-green-400 mb-2">Query executed successfully. (1 row affected)</div>
                <table class="w-full text-left border-collapse mt-2">
                    <thead>
                        <tr class="border-b border-slate-700 text-slate-400">
                            <th class="p-2">ID</th>
                            <th class="p-2">Name</th>
                            <th class="p-2">Role</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="border-b border-slate-800 font-mono text-slate-300">
                            <td class="p-2">1</td>
                            <td class="p-2">Paarthibhan</td>
                            <td class="p-2">Admin</td>
                        </tr>
                        <tr class="border-b border-slate-800 font-mono text-slate-300">
                            <td class="p-2">2</td>
                            <td class="p-2">User_Guest</td>
                            <td class="p-2">Visitor</td>
                        </tr>
                    </tbody>
                </table>`;
            } else if (upperCode.includes('CREATE TABLE')) {
                output = `<div class="text-green-400">Command(s) completed successfully.</div>`;
            } else if (upperCode.includes('INSERT INTO')) {
                output = `<div class="text-green-400">Query OK, 1 row affected.</div>`;
            } else if (upperCode.trim() === '') {
                 output = `<div class="text-yellow-400">No query selected.</div>`;
            } else {
                output = `<div class="text-red-400">Error 1064 (42000): You have an error in your SQL syntax; this is a client-side demo simulator.</div>`;
            }

            consoleOutput.innerHTML = output;
        }

        // Support Tab key in textarea
        editor.addEventListener('keydown', function(e) {
            if (e.key == 'Tab') {
                e.preventDefault();
                var start = this.selectionStart;
                var end = this.selectionEnd;

                // set textarea value to: text before caret + tab + text after caret
                this.value = this.value.substring(0, start) +
                    "\t" + this.value.substring(end);

                // put caret at right position again
                this.selectionStart = this.selectionEnd = start + 1;
            }
        });

    </script>
</body>
</html>
